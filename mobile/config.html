<!DOCTYPE html>
<html lang="en">
<head>
<title>Guild Wars 2 API Test</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"></meta>
<script type='text/javascript' src='js/jquery-1.9.1.min.js' ></script>
<meta name="viewport" content="width=320, initial-scale=1, maximum-scale=1">
<link href='css/bootstrap.min.css' rel='stylesheet' media='screen'></link>
<script type='text/javascript' src='js/bootstrap.min.js'></script>
<link href='css/wvwtimers-widget-style.css' rel='stylesheet' media='screen'></link>
</head>
<body>
<div class="navbar">
  <div class="navbar-inner" style="padding-left:0;padding-right:0;">
  <ul class="nav pull-left">
    <li><a href="index.html"><i class=" icon-chevron-left" style="font-size:30px;"></i></a></li>
    <li class="divider-vertical"></li>
  </ul>	
  <a class="brand" href="#">Settings</a>
  </div>
</div>
<center>
<div class="btn-group" style="display:block;">
  <button class="btn" id="lang-en">EN</button>
  <button class="btn" id="lang-es">ES</button>
</div>
</br>
<div class="WvWTimers-widget">
    <ul class="nav nav-tabs" id="myTab">
    <li class="active"><a href="#NAserverList">North America</a></li>
    <li><a href="#EUserverList">European Union</a></li>
    </ul>
     
    <div class="tab-content">
    <div class="tab-pane active" id="NAserverList"></div>
    <div class="tab-pane" id="EUserverList"></div>
    </div>
     
    <script>
    $('#myTab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
    })
    </script>
</div>
</center>
<script type="text/javascript">
function loadServerList()
{
  $.getJSON("https://api.guildwars2.com/v1/world_names.json?lang="+localStorage.lang, function (world_names) {
    $.each(world_names, function(index, value) {
      var foo ="";
      if(value.id < "2000")
        foo ="#NAserverList";
      else
        foo ="#EUserverList";

      var cl = "serverbox";
      if (localStorage.server_id != undefined && localStorage.server_id == value.id)
        cl += " active";
      $(foo).append("<div class='"+cl+"' id='"+value.id+"'>"+value.name+"</div>");
    });


  $(".serverbox").click(function(){
    $(".serverbox").removeClass("active");
    $(this).addClass("active");
    localStorage.server_id = $(this).attr("id");
  });

  });
}

$(document).ready(function(){
  if(localStorage.server_id != undefined)
  {
    $("#appendedInputButton").val(localStorage.server_id);
  }

  $("#btn-set").click(function(){
    localStorage.server_id = $("#appendedInputButton").val();
    window.location = "index.html";
  });

  if(localStorage.lang == undefined)
  {
    localStorage.lang = "en";
    $("#lang-en").addClass("active");
  }
  else
  {
    $("#lang-"+localStorage.lang).addClass("active");
  }

  $("#lang-es").click(function()
  {
    $("#lang-en").removeClass("active");
    $("#lang-es").addClass("active");
    localStorage.lang = "es";
    $("#NAserverList").empty();
    $("#EUserverList").empty();
    loadServerList();
  });

  $("#lang-en").click(function()
  {
    $("#lang-es").removeClass("active");
    $("#lang-en").addClass("active");
    localStorage.lang = "en";
    $("#NAserverList").empty();
    $("#EUserverList").empty();
    loadServerList();
  });

  loadServerList();
});
</script>
</body>
</html>